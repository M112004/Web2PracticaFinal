{
    "info": {
      "name": "Albaranes API",
      "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
      "_postman_id": "12345678-abcd-efgh-ijkl-1234567890ab"
    },
    "variable": [
      { "key": "baseUrl", "value": "http://localhost:4000/api" },
      { "key": "token", "value": "" },
      { "key": "clientId", "value": "" }
    ],
    "item": [
      {
        "name": "1. Register User",
        "request": {
          "method": "POST",
          "header": [
            { "key": "Content-Type", "value": "application/json" }
          ],
          "body": {
            "mode": "raw",
            "raw": "{\n  \"email\": \"miquel.angel.prieto@gmail.com\",\n  \"password\": \"MiPassword123\"\n}"
          },
          "url": {
            "raw": "{{baseUrl}}/users/register",
            "host": ["{{baseUrl}}"],
            "path": ["users","register"]
          }
        },
        "event": [
          {
            "listen": "test",
            "script": {
              "exec": [
                "if (pm.response.code === 201) {",
                "  var json = pm.response.json();",
                "  pm.collectionVariables.set('token', json.token);",
                "}"
              ]
            }
          }
        ]
      },
      {
        "name": "2. Validate Email",
        "request": {
          "method": "PUT",
          "header": [
            { "key": "Content-Type", "value": "application/json" },
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "body": {
            "mode": "raw",
            "raw": "{\n  \"code\": \"REPLACE_WITH_CODE\"\n}"
          },
          "url": {
            "raw": "{{baseUrl}}/users/validation",
            "host": ["{{baseUrl}}"],
            "path": ["users","validation"]
          }
        }
      },
      {
        "name": "3. Login User",
        "request": {
          "method": "POST",
          "header": [
            { "key": "Content-Type", "value": "application/json" }
          ],
          "body": {
            "mode": "raw",
            "raw": "{\n  \"email\": \"miquel.angel.prieto@gmail.com\",\n  \"password\": \"MiPassword123\"\n}"
          },
          "url": {
            "raw": "{{baseUrl}}/users/login",
            "host": ["{{baseUrl}}"],
            "path": ["users","login"]
          }
        },
        "event": [
          {
            "listen": "test",
            "script": {
              "exec": [
                "if (pm.response.code === 200) {",
                "  var json = pm.response.json();",
                "  pm.collectionVariables.set('token', json.token);",
                "}"
              ]
            }
          }
        ]
      },
      {
        "name": "4. Update Personal Data",
        "request": {
          "method": "PUT",
          "header": [
            { "key": "Content-Type", "value": "application/json" },
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "body": {
            "mode": "raw",
            "raw": "{\n  \"nombre\": \"Juan\",\n  \"apellidos\": \"Pérez\",\n  \"telefono\": \"600123456\"\n}"
          },
          "url": {
            "raw": "{{baseUrl}}/users",
            "host": ["{{baseUrl}}"],
            "path": ["users"]
          }
        }
      },
      {
        "name": "5. Update Company Data",
        "request": {
          "method": "PATCH",
          "header": [
            { "key": "Content-Type", "value": "application/json" },
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "body": {
            "mode": "raw",
            "raw": "{\n  \"nombre\": \"Acme S.L.\",\n  \"direccion\": \"Calle Falsa 123\"\n}"
          },
          "url": {
            "raw": "{{baseUrl}}/users/company",
            "host": ["{{baseUrl}}"],
            "path": ["users","company"]
          }
        }
      },
      {
        "name": "6. Create Client",
        "request": {
          "method": "POST",
          "header": [
            { "key": "Content-Type", "value": "application/json" },
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "body": {
            "mode": "raw",
            "raw": "{\n  \"name\": \"Cliente1\",\n  \"email\": \"c1@example.com\",\n  \"phone\": \"600000001\",\n  \"address\": \"Dirección 1\"\n}"
          },
          "url": {
            "raw": "{{baseUrl}}/clients",
            "host": ["{{baseUrl}}"],
            "path": ["clients"]
          }
        },
        "event": [
          {
            "listen": "test",
            "script": {
              "exec": [
                "if (pm.response.code === 201) {",
                "  var json = pm.response.json();",
                "  pm.collectionVariables.set('clientId', json._id);",
                "}"
              ]
            }
          }
        ]
      },
      {
        "name": "7. Get All Clients",
        "request": {
          "method": "GET",
          "header": [
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "url": {
            "raw": "{{baseUrl}}/clients",
            "host": ["{{baseUrl}}"],
            "path": ["clients"]
          }
        }
      },
      {
        "name": "8. Get Client By ID",
        "request": {
          "method": "GET",
          "header": [
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "url": {
            "raw": "{{baseUrl}}/clients/{{clientId}}",
            "host": ["{{baseUrl}}"],
            "path": ["clients","{{clientId}}"]
          }
        }
      },
      {
        "name": "9. Update Client",
        "request": {
          "method": "PUT",
          "header": [
            { "key": "Content-Type", "value": "application/json" },
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "body": {
            "mode": "raw",
            "raw": "{\n  \"phone\": \"699999999\"\n}"
          },
          "url": {
            "raw": "{{baseUrl}}/clients/{{clientId}}",
            "host": ["{{baseUrl}}"],
            "path": ["clients","{{clientId}}"]
          }
        }
      },
      {
        "name": "10. Archive Client",
        "request": {
          "method": "PATCH",
          "header": [
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "url": {
            "raw": "{{baseUrl}}/clients/{{clientId}}/archive",
            "host": ["{{baseUrl}}"],
            "path": ["clients","{{clientId}}","archive"]
          }
        }
      },
      {
        "name": "11. Delete Client",
        "request": {
          "method": "DELETE",
          "header": [
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "url": {
            "raw": "{{baseUrl}}/clients/{{clientId}}",
            "host": ["{{baseUrl}}"],
            "path": ["clients","{{clientId}}"]
          }
        }
      },
      {
        "name": "12. Get Archived Clients",
        "request": {
          "method": "GET",
          "header": [
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "url": {
            "raw": "{{baseUrl}}/clients/archived/all",
            "host": ["{{baseUrl}}"],
            "path": ["clients","archived","all"]
          }
        }
      },
      {
        "name": "13. Restore Client",
        "request": {
          "method": "PATCH",
          "header": [
            { "key": "Authorization", "value": "Bearer {{token}}" }
          ],
          "url": {
            "raw": "{{baseUrl}}/clients/{{clientId}}/restore",
            "host": ["{{baseUrl}}"],
            "path": ["clients","{{clientId}}","restore"]
          }
        }
      }
    ]
  }
  